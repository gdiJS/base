/* global __dde */

var DDE = function (win) {
    var T = this;
    T.hwnd = 0;
    T._ = $dde;

    T.refresh = function () {
        T.hwnd = T._.find(win);
    };

    T.write = function (string) {
        T._.send(T.hwnd, string);
    };

    T.send = function (cmd, param) {
        if (typeof param === "undefined") {
            param = "null";
        }
        T.write(JSON.stringify({"c": cmd, "p": param}));
    };
    T.refresh();
    return T;
}();


